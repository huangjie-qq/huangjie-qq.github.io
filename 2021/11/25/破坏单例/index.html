<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="å°çƒæŸ">
    
    <title>
        
            ç ´åå•ä¾‹ |
        
        å°çƒæŸçš„åšå®¢
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/itang.svg">
    
<link rel="stylesheet" href="/css/font-awesome.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":false,"number":false,"expand_all":false,"init_open":false},"style":{"primary_color":"#0066CC","avatar":"/images/itang.svg","favicon":"/images/itang.svg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"ä¼šä¸€ç‚¹javaåˆçˆ±å·åƒçš„çŒ«"},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"default"},"pjax":{"enable":false},"lazyload":{"enable":false},"version":"3.4.3"};
    KEEP.language_ago = {"second":"%s ç§’å‰","minute":"%s åˆ†é’Ÿå‰","hour":"%s å°æ—¶å‰","day":"%s å¤©å‰","week":"%s å‘¨å‰","month":"%s æœˆå‰","year":"%s å¹´å‰"};
  </script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                å°çƒæŸçš„åšå®¢
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                é¦–é¡µ
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                æ–‡ç« 
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">é¦–é¡µ</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">æ–‡ç« </a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">ç ´åå•ä¾‹</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/itang.svg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">å°çƒæŸ</span>
                        
                            <span class="author-label">é“²å±å®˜</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;2021-11-25 23:25:27
    </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">è®¾è®¡æ¨¡å¼</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>2.9k å­—</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>12 åˆ†é’Ÿ</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h1 id="ç ´åå•ä¾‹"><a href="#ç ´åå•ä¾‹" class="headerlink" title="ç ´åå•ä¾‹"></a>ç ´åå•ä¾‹</h1><p>æ€ä¹ˆç ´åå•ä¾‹å‘¢ï¼Ÿ</p>
<p>å¯ä»¥ä»ååºåˆ—åŒ–å’Œåå°„æ¥ç ´åã€‚</p>
<p>å¯¹äº<a class="link"   target="_blank" rel="noopener" href="https://huangjie-qq.github.io/2021/11/16/%E5%8D%95%E4%BE%8B%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" >ä¸Šä¸€ç¯‡<i class="fas fa-external-link-alt"></i></a>è®²çš„äº”ç§å†™æ³•ï¼Œæˆ‘ä»¬åˆ†åˆ«æ¥ç ´åï¼Œçœ‹çœ‹æ˜¯ä¸ªä»€ä¹ˆæƒ…å†µã€‚</p>
<h4 id="é¥¿æ±‰å¼ï¼š"><a href="#é¥¿æ±‰å¼ï¼š" class="headerlink" title="é¥¿æ±‰å¼ï¼š"></a>é¥¿æ±‰å¼ï¼š</h4><h5 id="ååºåˆ—åŒ–æ”»å‡»ï¼šé¥¿æ±‰å¼"><a href="#ååºåˆ—åŒ–æ”»å‡»ï¼šé¥¿æ±‰å¼" class="headerlink" title="ååºåˆ—åŒ–æ”»å‡»ï¼šé¥¿æ±‰å¼"></a>ååºåˆ—åŒ–æ”»å‡»ï¼šé¥¿æ±‰å¼</h5><pre><code class="java">public static void main(String[] args) throws Exception&#123;
        HungrySingleton instance = HungrySingleton.getInstance();
        ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(&quot;instance_file&quot;));
        oos.writeObject(instance);

        File file = new File(&quot;instance_file&quot;);
        ObjectInputStream ois = new ObjectInputStream(new FileInputStream(file));
        HungrySingleton readObject = (HungrySingleton)ois.readObject();

        System.out.println(instance);
        System.out.println(readObject);
        System.out.println(instance==readObject);
    &#125;
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="https://my-xqm-srb.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2/%E7%A0%B4%E5%9D%8F%E5%8D%95%E4%BE%8B/1.png" alt="avatar"></p>
<p>ç»è¿‡äº†åºåˆ—åŒ–å’Œååºåˆ—åŒ–ä¹‹å ï¼Œé¥¿æ±‰å¼å°±äº§ç”Ÿäº†ä¸¤ä¸ªå¯¹è±¡ ï¼Œå¾ˆæ˜¾ç„¶è¿™æ ·å°±è¿èƒŒäº†å•ä¾‹è®¾è®¡çš„åŸåˆ™ã€‚ </p>
<p>é‚£ä¹ˆæ€ä¹ˆè§£å†³ååºåˆ—åŒ–æ”»å‡»å‘¢ï¼Ÿ</p>
<p>åœ¨HungrySingletonä¸­ç¼–å†™ä¸€ä¸ªreadResolve()æ–¹æ³•ä»£ç å¦‚ä¸‹</p>
<pre><code class="java">/**
 * @Authorï¼šå°çƒæŸ
 * @Dateï¼š2021/11/16/23:47
 * é¥¿æ±‰å¼
 */
public class HungrySingleton implements Serializable &#123;
    private HungrySingleton()&#123;&#125;;

    private static final HungrySingleton SINGLETON=new HungrySingleton();

    public static HungrySingleton getInstance()&#123;
       return SINGLETON;
    &#125;

    /**
     * é˜²æ­¢ååºåˆ—åŒ–
     * @return
     */
    private Object readResolve()&#123;
        return SINGLETON;
    &#125;
&#125;
</code></pre>
<p>ç„¶åé‡æ–°è¿è¡Œï¼š</p>
<p><img src="https://my-xqm-srb.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2/%E7%A0%B4%E5%9D%8F%E5%8D%95%E4%BE%8B/0.png" alt="avatar"></p>
<p>ä¸ºä»€ä¹ˆæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªreadResolve()æ–¹æ³•å°±èƒ½ä¿è¯å®‰å…¨å‘¢ï¼Ÿ</p>
<p>ä»readObject()æ–¹æ³•å…¥æ‰‹åˆ†æã€‚</p>
<p><img src="https://my-xqm-srb.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2/%E7%A0%B4%E5%9D%8F%E5%8D%95%E4%BE%8B/2.png" alt="avatar"></p>
<p>è¿›åˆ° readObject0æ–¹æ³•ä¸­</p>
<p><img src="https://my-xqm-srb.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2/%E7%A0%B4%E5%9D%8F%E5%8D%95%E4%BE%8B/3.png" alt="avatar"></p>
<p>ç»§ç»­è¿›åˆ° readOrdinaryObject(unshared)æ–¹æ³•ä¸­</p>
<p><img src="https://my-xqm-srb.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2/%E7%A0%B4%E5%9D%8F%E5%8D%95%E4%BE%8B/4.png" alt="avatar"></p>
<p>ç»§ç»­è¿›åˆ° desc.isInstantiable()æ–¹æ³•ä¸­</p>
<p><img src="https://my-xqm-srb.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2/%E7%A0%B4%E5%9D%8F%E5%8D%95%E4%BE%8B/5.png" alt="avatar"></p>
<p>isInstantiable()æ–¹æ³•ä¸­çš„æ³¨é‡Šè®²ï¼Œå¦‚æœè¡¨ç¤ºçš„ç±»æ˜¯å¯åºåˆ—åŒ–/å¯å¤–éƒ¨åŒ–çš„å¹¶ä¸”å¯ä»¥ç”±åºåˆ—åŒ–è¿è¡Œæ—¶å®ä¾‹åŒ–ï¼Œåˆ™è¿”å› true  ã€‚</p>
<p>é‚£ä¹ˆ2011è¡Œä»£ç çš„ desc.isInstantiable()è¿”å›true  ï¼Œæ ¹æ®ä¸‰ç›®è¿ç®—ç¬¦ï¼Œå°±ä¼šæ‰§è¡Œ desc.newInstance()æ–¹æ³•ã€‚</p>
<p>ç»§ç»­è¿›åˆ°newInstance()æ–¹æ³•</p>
<p><img src="https://my-xqm-srb.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2/%E7%A0%B4%E5%9D%8F%E5%8D%95%E4%BE%8B/-1.png" alt="avatar"></p>
<p>åœ¨è¿™é‡Œæœ€ä¸»è¦çš„ä¸€å¥æ˜¯ cons.newInstance();</p>
<p>é‚£æˆ‘ä»¬çœ‹çœ‹ consæ˜¯ä¸ªä»€ä¹ˆ</p>
<p><img src="https://my-xqm-srb.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2/%E7%A0%B4%E5%9D%8F%E5%8D%95%E4%BE%8B/-2.png" alt="avatar"></p>
<p>åŸæ˜¯ä¸€ä¸ªæ„é€ å™¨ï¼Œæ‰€ä»¥cons.newInstance(); å°±æ˜¯ç”¨åå°„åˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡ã€‚</p>
<p>æ‰€ä»¥åœ¨è¿™é‡Œä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆä¼šç ´åå•ä¾‹ å®ƒæ˜¯ç”¨åå°„newäº†ä¸ªæ–°å¯¹è±¡ã€‚</p>
<p>è¿™æ ·ä¸€æ¥2009è¡Œçš„ objå¯¹è±¡å°±ä¸ä¸ºç©ºã€‚æˆ‘ä»¬ç»§ç»­å¾€readOrdinaryObject()æ–¹æ³•å¾€ä¸‹çœ‹</p>
<p><img src="https://my-xqm-srb.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2/%E7%A0%B4%E5%9D%8F%E5%8D%95%E4%BE%8B/6.png" alt="avatar"></p>
<p>æ¥åˆ°2032è¡Œï¼Œå› ä¸ºobjä¸ä¸ºç©º æ‰€ä»¥ä¼šæ‰§è¡Œåˆ° 2033è¡Œçš„handles.lookupException(passHandle)æ–¹æ³•</p>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹ ä¼ é€’çš„å‚æ•°passHandleç­‰äºä»€ä¹ˆã€‚</p>
<p><img src="https://my-xqm-srb.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2/%E7%A0%B4%E5%9D%8F%E5%8D%95%E4%BE%8B/7.png" alt="avatar"></p>
<p>ç„¶åç»§ç»­è¿›åˆ°lookupException()æ–¹æ³•ä¸­å»</p>
<p><img src="https://my-xqm-srb.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2/%E7%A0%B4%E5%9D%8F%E5%8D%95%E4%BE%8B/8.png" alt="avatar"></p>
<p>lookupException()æ–¹æ³•ä¸­çš„æ³¨é‡Šä¹Ÿè¯´å¾—å¾ˆæ¸…æ¥šäº†ï¼Œ å¦‚æœç»™å®šçš„å¥æŸ„æ˜¯ NULL_HANDLEï¼Œæˆ–è€…æ²¡æœ‰ä¸å¥æŸ„å…³è”çš„ ClassNotFoundExceptionï¼Œåˆ™è¿”å› nullã€‚</p>
<p>æ‰€ä»¥2033è¡Œä¸­çš„ handles.lookupException(passHandle) == null ä¸ºtrue ã€‚</p>
<p>ä¼šç»§ç»­æ‰§è¡Œ2034è¡Œçš„desc.hasReadResolveMethod()æ–¹æ³•ï¼Œç»§ç»­è·Ÿè¿›å»ã€‚</p>
<p><img src="https://my-xqm-srb.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2/%E7%A0%B4%E5%9D%8F%E5%8D%95%E4%BE%8B/9.png" alt="avatar"></p>
<p>hasReadResolveMethodæ–¹æ³•çš„æ³¨é‡Šä¹Ÿè¯´å¾—å¾ˆæ˜ç™½äº†ï¼Œå®šä¹‰äº†ä¸€è‡´çš„ readResolve æ–¹æ³•ï¼Œåˆ™è¿”å› trueã€‚</p>
<p>å› ä¸ºæˆ‘ä»¬å†™äº†ä¸€ä¸ªreadResolve æ–¹æ³•ï¼Œæ‰€ä»¥æ•´ä¸ªè¡¨è¾¾å¼çš„ç»“æœä¸ºtrue ï¼Œè¿›å…¥ifã€‚</p>
<p>æ‰§è¡Œ2036è¡Œçš„Object rep = desc.invokeReadResolve(obj)ä»£ç ã€‚</p>
<p>ç»§ç»­è¿›åˆ° invokeReadResolve(obj)æ–¹æ³•ä¸­</p>
<p><img src="https://my-xqm-srb.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2/%E7%A0%B4%E5%9D%8F%E5%8D%95%E4%BE%8B/10.png" alt="avatar"></p>
<p>invokeReadResolveæ–¹æ³•çš„æ³¨é‡Šè¯´ï¼ŒreadResolve æ–¹æ³•å¹¶è¿”å›ç»“æœã€‚</p>
<p>æˆ‘ä»¬åœ¨HungrySingletonä¸­çš„ä»£ç æ˜¯è¿”å›å•ä¾‹å¯¹è±¡</p>
<pre><code class="java"> /**
     * é˜²æ­¢ååºåˆ—åŒ–
     * @return
     */
    private Object readResolve()&#123;
        return SINGLETON;
    &#125;
</code></pre>
<p>æ‰€ä»¥åœ¨2036è¡Œä»£ç ä¸­çš„rep ç­‰äºæˆ‘ä»¬çš„å•ä¾‹å¯¹è±¡ã€‚</p>
<p>ç»§ç»­å¾€ä¸‹çœ‹</p>
<p><img src="https://my-xqm-srb.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2/%E7%A0%B4%E5%9D%8F%E5%8D%95%E4%BE%8B/11.png" alt="avatar"></p>
<p>æ¥åˆ°2040è¡Œä»£ç ï¼Œ repæ˜¯å•ä¾‹å¯¹è±¡  objæ˜¯åå°„çš„å¯¹è±¡ è‡ªç„¶ä¸ä¼šç›¸ç­‰ è¿›å…¥ifï¼Œæœ€ç»ˆå°†objæŒ‡å‘å•ä¾‹å¯¹è±¡ å¹¶è¿”å›å‡ºå»ã€‚</p>
<p>æ‰€ä»¥è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå†™ä¸€ä¸ªreadResolve()æ–¹æ³•å°±èƒ½é˜²æ­¢ååºåˆ—åŒ–æ”»å‡»äº†ã€‚</p>
<p>å°ç»“ï¼šreadObject()æ–¹æ³•ä¼šæ£€æŸ¥ç±»ä¸­æœ‰æ²¡æœ‰readResolve()æ–¹æ³•ï¼Œå¦‚æœæœ‰åˆ™è°ƒç”¨ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨readResolve()æ–¹æ³•ä¸­æ·»åŠ æˆ‘ä»¬çš„é€»è¾‘ ï¼Œä»è€Œè¾¾åˆ°å•ä¾‹çš„å®‰å…¨ã€‚</p>
<p>ååºåˆ—åŒ–æ”»å‡»çœ‹å®Œäº†ï¼Œæˆ‘ä»¬ç»§ç»­æ¥çœ‹åå°„æ”»å‡»ã€‚</p>
<h5 id="åå°„æ”»å‡»ï¼šé¥¿æ±‰å¼"><a href="#åå°„æ”»å‡»ï¼šé¥¿æ±‰å¼" class="headerlink" title="åå°„æ”»å‡»ï¼šé¥¿æ±‰å¼"></a>åå°„æ”»å‡»ï¼šé¥¿æ±‰å¼</h5><pre><code class="java"> public static void main(String[] args) throws Exception&#123;

        HungrySingleton instance = HungrySingleton.getInstance();

        Class&lt;HungrySingleton&gt; aClass = HungrySingleton.class;
        Constructor&lt;HungrySingleton&gt; constructor = aClass.getDeclaredConstructor();
        constructor.setAccessible(true);
        HungrySingleton newInstance = constructor.newInstance(null);

        System.out.println(instance);
        System.out.println(newInstance);
        System.out.println(instance==newInstance);
    &#125;
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="https://my-xqm-srb.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2/%E7%A0%B4%E5%9D%8F%E5%8D%95%E4%BE%8B/12.png" alt="avatar"></p>
<p>é€šè¿‡åå°„ æ‰“å¼€ç§æœ‰æ„é€ å™¨æƒé™ï¼Œå°±å¯ä»¥newå‡ºæ–°çš„å¯¹è±¡ï¼Œä»è€Œç ´åå•ä¾‹ã€‚</p>
<p>é‚£ä¹ˆæ€ä¹ˆè§£å†³å‘¢ï¼Ÿ</p>
<pre><code class="java">private HungrySingleton()&#123;
      if(SINGLETON!=null)
        throw new RuntimeException(&quot;å•ä¾‹æ„é€ å™¨ ç¦æ­¢åå°„ç ´å&quot;);
 &#125;;
</code></pre>
<p>åœ¨ç§æœ‰æ„é€ å‡½æ•°ä¸­åˆ¤æ–­ï¼Œç¦æ­¢newå‡ºå¯¹è±¡ã€‚</p>
<p>å› ä¸ºé¥¿æ±‰å¼æ˜¯åœ¨ç±»åŠ è½½é˜¶æ®µæ—¶å€™åˆ›å»ºçš„ï¼Œåœ¨åå°„ä»£ç è°ƒç”¨æ—¶å°±å·²ç»å­˜åœ¨ï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p>
<p>ä»è€Œä¸ä¼šnewå‡ºä¸¤æ¬¡ï¼Œè¾¾åˆ°é˜²æ­¢åå°„å®‰å…¨ã€‚</p>
<h4 id="é™æ€å†…éƒ¨ç±»ï¼š"><a href="#é™æ€å†…éƒ¨ç±»ï¼š" class="headerlink" title="é™æ€å†…éƒ¨ç±»ï¼š"></a>é™æ€å†…éƒ¨ç±»ï¼š</h4><h5 id="ååºåˆ—åŒ–æ”»å‡»ï¼šé™æ€å†…éƒ¨ç±»"><a href="#ååºåˆ—åŒ–æ”»å‡»ï¼šé™æ€å†…éƒ¨ç±»" class="headerlink" title="ååºåˆ—åŒ–æ”»å‡»ï¼šé™æ€å†…éƒ¨ç±»"></a>ååºåˆ—åŒ–æ”»å‡»ï¼šé™æ€å†…éƒ¨ç±»</h5><pre><code class="java"> public static void main(String[] args) throws Exception&#123;

        StaticInnerClassSingleton instance = StaticInnerClassSingleton.getInstance();
        ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(&quot;instance_file&quot;));
        oos.writeObject(instance);

        File file = new File(&quot;instance_file&quot;);
        ObjectInputStream ois = new ObjectInputStream(new FileInputStream(file));
        StaticInnerClassSingleton readObject = (StaticInnerClassSingleton)ois.readObject();

        System.out.println(instance);
        System.out.println(readObject);
        System.out.println(instance==readObject);
    &#125;
</code></pre>
<p>ç»“æœå’Œä¸Šé¢é¥¿æ±‰å¼è¡¨ç°ä¸€æ ·ï¼Œä¼šè¢«ç ´åï¼Œéœ€è¦ç¼–å†™ä¸€ä¸ªreadResolve()æ–¹æ³•ä»£ç ï¼Œæ‰èƒ½ååºåˆ—åŒ–å®‰å…¨ã€‚</p>
<pre><code class="java">/**
 * @Authorï¼šçƒæŸ
 * @Dateï¼š2021/11/17/1:44
 * é™æ€å†…éƒ¨ç±»
 */
public class StaticInnerClassSingleton implements Serializable &#123;

    private StaticInnerClassSingleton()&#123;&#125;

    private static class InnerClass&#123;
       private static StaticInnerClassSingleton singleton=new StaticInnerClassSingleton();
    &#125;

    public static StaticInnerClassSingleton getInstance()&#123;
        return InnerClass.singleton;
    &#125;

    /**
     * é˜²æ­¢ååºåˆ—åŒ–
     * @return
     */
    private Object readResolve()&#123;
        return InnerClass.singleton;
    &#125;
&#125;
</code></pre>
<h5 id="åå°„æ”»å‡»ï¼šé™æ€å†…éƒ¨ç±»"><a href="#åå°„æ”»å‡»ï¼šé™æ€å†…éƒ¨ç±»" class="headerlink" title="åå°„æ”»å‡»ï¼šé™æ€å†…éƒ¨ç±»"></a>åå°„æ”»å‡»ï¼šé™æ€å†…éƒ¨ç±»</h5><pre><code class="java"> public static void main(String[] args) throws Exception&#123;

        StaticInnerClassSingleton instance = StaticInnerClassSingleton.getInstance();

        Class&lt;StaticInnerClassSingleton&gt; aClass = StaticInnerClassSingleton.class;
        Constructor&lt;StaticInnerClassSingleton&gt; constructor = aClass.getDeclaredConstructor();
        constructor.setAccessible(true);
        StaticInnerClassSingleton newInstance = constructor.newInstance(null);

        System.out.println(instance);
        System.out.println(newInstance);
        System.out.println(instance==newInstance);
    &#125;
</code></pre>
<p>è¡¨ç°ç»“æœè¿˜æ˜¯å’Œä¸Šé¢é¥¿æ±‰å¼ï¼Œä¹Ÿé˜²å¾¡ä¸äº†åå°„æ”»å‡»ï¼Œä¹Ÿéœ€è¦åœ¨æ„é€ å‡½æ•°ä¸­åˆ¤æ–­ã€‚</p>
<pre><code>/**
 * @Authorï¼šçƒæŸ
 * @Dateï¼š2021/11/17/1:44
 * é™æ€å†…éƒ¨ç±»
 */
public class StaticInnerClassSingleton implements Serializable &#123;

    private StaticInnerClassSingleton()&#123;
        if(InnerClass.singleton!=null)
            throw new RuntimeException(&quot;å•ä¾‹æ„é€ å™¨ ç¦æ­¢åå°„ç ´å&quot;);
    &#125;

    private static class InnerClass&#123;
       private static StaticInnerClassSingleton singleton=new StaticInnerClassSingleton();
    &#125;

    public static StaticInnerClassSingleton getInstance()&#123;
        return InnerClass.singleton;
    &#125;

    /**
     * é˜²æ­¢ååºåˆ—åŒ–
     * @return
     */
    private Object readResolve()&#123;
        return InnerClass.singleton;
    &#125;
&#125;
</code></pre>
<p>å› ä¸ºé™æ€å†…éƒ¨ç±»ï¼Œä¹Ÿæ˜¯åœ¨ä½¿ç”¨æ˜¯æ‰åŠ è½½ï¼Œæ‰€ä»¥ä¹Ÿèƒ½ä¿è¯åå°„çš„å®‰å…¨ã€‚</p>
<h4 id="æ‡’æ±‰å¼ï¼š"><a href="#æ‡’æ±‰å¼ï¼š" class="headerlink" title="æ‡’æ±‰å¼ï¼š"></a>æ‡’æ±‰å¼ï¼š</h4><h5 id="åºåˆ—åŒ–æ”»å‡»ï¼šæ‡’æ±‰å¼"><a href="#åºåˆ—åŒ–æ”»å‡»ï¼šæ‡’æ±‰å¼" class="headerlink" title="åºåˆ—åŒ–æ”»å‡»ï¼šæ‡’æ±‰å¼"></a>åºåˆ—åŒ–æ”»å‡»ï¼šæ‡’æ±‰å¼</h5><pre><code class="java">public static void main(String[] args) throws Exception&#123;

        LazySingleton instance = LazySingleton.getInstance();
        ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(&quot;instance_file&quot;));
        oos.writeObject(instance);

        File file = new File(&quot;instance_file&quot;);
        ObjectInputStream ois = new ObjectInputStream(new FileInputStream(file));
        LazySingleton readObject = (LazySingleton)ois.readObject();

        System.out.println(instance);
        System.out.println(readObject);
        System.out.println(instance==readObject);
    &#125;
</code></pre>
<p>ç»“æœå’Œä¸Šé¢éƒ½æ˜¯ä¸€æ ·ï¼Œé˜²å¾¡ä¸äº†åºåˆ—åŒ–æ”»å‡»ï¼Œä¹Ÿæ˜¯è¦æä¾›readResolve()æ–¹æ³•ã€‚</p>
<pre><code class="java">/**
 * @Authorï¼šå°çƒæŸ
 * @Dateï¼š2021/11/16/23:56
 * æ‡’æ±‰å¼
 */
public class LazySingleton implements Serializable &#123;
    private LazySingleton()&#123;&#125;;

    private static volatile LazySingleton SINGLETEN;

    public static LazySingleton getInstance()&#123;
        if(SINGLETEN==null)&#123;//è¯­å¥1
            synchronized (LazySingleton.class)&#123;//è¯­å¥2
                if(SINGLETEN==null)&#123;
                    SINGLETEN=new LazySingleton();
                &#125;
            &#125;
        &#125;
        return SINGLETEN;
    &#125;

    /**
     * é˜²æ­¢ååºåˆ—åŒ–
     * @return
     */
    private Object readResolve()&#123;
        return SINGLETEN;
    &#125;
&#125;
</code></pre>
<h5 id="åå°„æ”»å‡»ï¼šæ‡’æ±‰å¼"><a href="#åå°„æ”»å‡»ï¼šæ‡’æ±‰å¼" class="headerlink" title="åå°„æ”»å‡»ï¼šæ‡’æ±‰å¼"></a>åå°„æ”»å‡»ï¼šæ‡’æ±‰å¼</h5><pre><code class="java"> public static void main(String[] args) throws Exception&#123;

        LazySingleton instance = LazySingleton.getInstance();

        Class&lt;LazySingleton&gt; aClass = LazySingleton.class;
        Constructor&lt;LazySingleton&gt; constructor = aClass.getDeclaredConstructor();
        constructor.setAccessible(true);
        LazySingleton newInstance = constructor.newInstance(null);

        System.out.println(instance);
        System.out.println(newInstance);
        System.out.println(instance==newInstance);
    &#125;
</code></pre>
<p>ç»“æœä¹Ÿæ˜¯ä¸€æ · ä¸èƒ½é˜²å¾¡åå°„çš„æ”»å‡»ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç»§ç»­åœ¨æ„é€ å‡½æ•°ä¸­ç»§ç»­åˆ¤æ–­ã€‚</p>
<pre><code class="java">/**
 * @Authorï¼šå°çƒæŸ
 * @Dateï¼š2021/11/16/23:56
 * æ‡’æ±‰å¼
 */
public class LazySingleton implements Serializable &#123;

    private LazySingleton()&#123;
        if(SINGLETEN!=null)
            throw new RuntimeException(&quot;å•ä¾‹æ„é€ å™¨ ç¦æ­¢åå°„ç ´å&quot;);
    &#125;;

    private static volatile LazySingleton SINGLETEN;

    public static LazySingleton getInstance()&#123;
        if(SINGLETEN==null)&#123;//è¯­å¥1
            synchronized (LazySingleton.class)&#123;//è¯­å¥2
                if(SINGLETEN==null)&#123;
                    SINGLETEN=new LazySingleton();
                &#125;
            &#125;
        &#125;
        return SINGLETEN;
    &#125;

    /**
     * é˜²æ­¢ååºåˆ—åŒ–
     * @return
     */
    private Object readResolve()&#123;
        return SINGLETEN;
    &#125;
&#125;
</code></pre>
<p>ç»§ç»­è¿è¡Œï¼š</p>
<p><img src="https://my-xqm-srb.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2/%E7%A0%B4%E5%9D%8F%E5%8D%95%E4%BE%8B/13.png" alt="avatar"></p>
<p>ç»“æœä¹Ÿè¾¾åˆ°äº†æˆ‘ä»¬é¢„æœŸï¼Œå¯æ˜¯è¿™æ ·çœŸçš„æ²¡ç”¨é—®é¢˜äº†å—ã€‚</p>
<p>æˆ‘ä»¬æ¢ä¸ªæ€è·¯ï¼Œè®©åå°„çš„ä»£ç å…ˆæ‰§è¡Œï¼ŒgetInstance()æ–¹æ³•åæ‰§è¡Œè¯•è¯•ã€‚</p>
<pre><code class="java"> public static void main(String[] args) throws Exception&#123;
        //åå°„å…ˆæ‰§è¡Œ
        Class&lt;LazySingleton&gt; aClass = LazySingleton.class;
        Constructor&lt;LazySingleton&gt; constructor = aClass.getDeclaredConstructor();
        constructor.setAccessible(true);
        LazySingleton newInstance = constructor.newInstance(null);

        LazySingleton instance = LazySingleton.getInstance();
        System.out.println(instance);
        System.out.println(newInstance);
        System.out.println(instance==newInstance);
    &#125;
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="https://my-xqm-srb.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2/%E7%A0%B4%E5%9D%8F%E5%8D%95%E4%BE%8B/14.png" alt="avatar"></p>
<p>ç»“æœåå°„åˆå†æ¬¡ç ´åäº†æˆ‘ä»¬çš„å•ä¾‹ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•å‘¢ã€‚</p>
<p>ä¸»è¦æ˜¯åœ¨æ„é€ å‡½æ•°é‡Œé¢åšåˆ¤æ–­ï¼Œå…¶å®ä¸ç®¡æ€ä¹ˆåšåˆ¤æ–­ï¼Œåå°„éƒ½å¯ä»¥é€šè¿‡æ‰“å¼€ç§æœ‰æƒé™ å»ç ´åã€‚</p>
<p>å› ä¸ºæ‡’æ±‰å¼æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯å»¶è¿ŸåŠ è½½ï¼Œåªæœ‰ç”¨åˆ°æ—¶å€™æ‰ä¼šåŠ è½½ï¼Œé‚£ä¹ˆåªè¦åœ¨åŠ è½½å‰ æ‰§è¡Œåå°„ä»£ç çš„è¯ å°±æ˜¯é¿å…ä¸äº†è¢«ç ´åçš„ã€‚æ‰€ä»¥æˆ‘ä»¬èƒ½åšçš„å°±æ˜¯å°½é‡çš„è®©åå°„çš„ä»£ç åæ‰§è¡Œ ï¼Œåœ¨å¤šçº¿ç¨‹ä¸‹ åŠ è½½çš„ä»£ç  å’Œåå°„ä»£ç æ˜¯ä¸åŒçº¿ç¨‹æ‰§è¡Œï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ— æ³•é¿å…ã€‚</p>
<p>ä¸Šé¢çš„é¥¿æ±‰å¼æ˜¯åŠ è½½ç±»é˜¶æ®µçš„æ—¶å€™å°±ä¼šåˆ›å»ºå‡ºï¼Œå³ä½¿å…ˆåå°„ä»£ç å…ˆæ‰§è¡Œï¼Œåå°„ä¹Ÿä¼šè§¦å‘ç±»çš„åŠ è½½ï¼Œä»è€Œå®Œæˆåˆ›å»ºï¼Œ</p>
<p>åœ¨newInstanceçš„æ—¶å€™ä¹Ÿå°±ä¼šæŠ¥é”™ã€‚è€Œé™æ€å†…éƒ¨ç±»æ˜¯ç”±JVMä¿è¯çš„å®‰å…¨ã€‚</p>
<p>å°ç»“ï¼šæ‡’æ±‰å¼åªèƒ½é˜²å¾¡ååºåˆ—åŒ–æ”»å‡»ï¼Œä¸èƒ½å®Œå…¨é˜²å¾¡åå°„æ”»å‡»ã€‚</p>
<h4 id="å®¹å™¨å•ä¾‹ï¼š"><a href="#å®¹å™¨å•ä¾‹ï¼š" class="headerlink" title="å®¹å™¨å•ä¾‹ï¼š"></a>å®¹å™¨å•ä¾‹ï¼š</h4><h5 id="ååºåˆ—åŒ–æ”»å‡»ï¼šå®¹å™¨å•ä¾‹"><a href="#ååºåˆ—åŒ–æ”»å‡»ï¼šå®¹å™¨å•ä¾‹" class="headerlink" title="ååºåˆ—åŒ–æ”»å‡»ï¼šå®¹å™¨å•ä¾‹"></a>ååºåˆ—åŒ–æ”»å‡»ï¼šå®¹å™¨å•ä¾‹</h5><pre><code class="java"> public static void main(String[] args) throws Exception&#123;

        ContainerSingleton instance = ContainerSingleton.getInstance();
        ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(&quot;instance_file&quot;));
        oos.writeObject(instance);

        File file = new File(&quot;instance_file&quot;);
        ObjectInputStream ois = new ObjectInputStream(new FileInputStream(file));
        ContainerSingleton readObject = (ContainerSingleton)ois.readObject();

        System.out.println(instance);
        System.out.println(readObject);
        System.out.println(instance==readObject);
    &#125;
</code></pre>
<p>ä¹Ÿæ˜¯å’Œå¤§å®¶ä¸€æ ·ï¼Œé˜²å¾¡ä¸äº†åºåˆ—åŒ–æ”»å‡»ï¼Œä¹Ÿæ˜¯è¦æä¾›readResolve()æ–¹æ³•ã€‚</p>
<pre><code class="java">/**
 * @Authorï¼šå°çƒæŸ
 * @Dateï¼š2021/11/17/1:54
 * å®¹å™¨å®ç°æ³•
 */
public class ContainerSingleton  implements Serializable &#123;
    private ContainerSingleton()&#123;&#125;;

    private static ConcurrentHashMap&lt;String, ContainerSingleton&gt; map=new ConcurrentHashMap();

    private static String KEY=&quot;singleten&quot;;

    public static ContainerSingleton getInstance()&#123;
        ContainerSingleton singleten = map.get(KEY);
        return singleten!=null?singleten:map.computeIfAbsent(KEY,s-&gt; new ContainerSingleton());
    &#125;

    /**
     * é˜²æ­¢ååºåˆ—åŒ–
     * @return
     */
    private Object readResolve()&#123;
        return map.get(KEY);
    &#125;
&#125;
</code></pre>
<h5 id="åå°„æ”»å‡»ï¼šå®¹å™¨å•ä¾‹-ç»™æ„é€ å‡½æ•°ä¸­æ·»åŠ åˆ¤æ–­-å¹¶è®©åå°„ä»£ç å…ˆæ‰§è¡Œ"><a href="#åå°„æ”»å‡»ï¼šå®¹å™¨å•ä¾‹-ç»™æ„é€ å‡½æ•°ä¸­æ·»åŠ åˆ¤æ–­-å¹¶è®©åå°„ä»£ç å…ˆæ‰§è¡Œ" class="headerlink" title="åå°„æ”»å‡»ï¼šå®¹å™¨å•ä¾‹ ç»™æ„é€ å‡½æ•°ä¸­æ·»åŠ åˆ¤æ–­ å¹¶è®©åå°„ä»£ç å…ˆæ‰§è¡Œ"></a>åå°„æ”»å‡»ï¼šå®¹å™¨å•ä¾‹ ç»™æ„é€ å‡½æ•°ä¸­æ·»åŠ åˆ¤æ–­ å¹¶è®©åå°„ä»£ç å…ˆæ‰§è¡Œ</h5><pre><code class="java">private ContainerSingleton()&#123;
    if(map.get(KEY)!=null)
      throw new RuntimeException(&quot;å•ä¾‹æ„é€ å™¨ ç¦æ­¢åå°„ç ´å&quot;);
 &#125;;
</code></pre>
<pre><code class="java"> public static void main(String[] args) throws Exception&#123;
        //åå°„å…ˆæ‰§è¡Œ
        Class&lt;ContainerSingleton&gt; aClass = ContainerSingleton.class;
        Constructor&lt;ContainerSingleton&gt; constructor = aClass.getDeclaredConstructor();
        constructor.setAccessible(true);
        ContainerSingleton newInstance = constructor.newInstance(null);

        ContainerSingleton instance = ContainerSingleton.getInstance();
        System.out.println(instance);
        System.out.println(newInstance);
        System.out.println(instance==newInstance);
    &#125;
</code></pre>
<p>è¡¨ç°ç»“æœä¹Ÿæ˜¯å’Œæ‡’æ±‰å¼ä¸€æ ·ï¼Œåªèƒ½é˜²å¾¡ä½ åå°„åæ‰§è¡Œçš„æƒ…å†µï¼Œå¦‚æœåå°„å…ˆæ‰§è¡Œå°±é˜²å¾¡ä¸äº†ã€‚</p>
<h4 id="æšä¸¾å•ä¾‹ï¼š"><a href="#æšä¸¾å•ä¾‹ï¼š" class="headerlink" title="æšä¸¾å•ä¾‹ï¼š"></a>æšä¸¾å•ä¾‹ï¼š</h4><h5 id="ååºåˆ—æ”»å‡»ï¼šæšä¸¾å•ä¾‹"><a href="#ååºåˆ—æ”»å‡»ï¼šæšä¸¾å•ä¾‹" class="headerlink" title="ååºåˆ—æ”»å‡»ï¼šæšä¸¾å•ä¾‹"></a>ååºåˆ—æ”»å‡»ï¼šæšä¸¾å•ä¾‹</h5><pre><code class="java"> public static void main(String[] args) throws Exception&#123;
        
        EnumSingleton instance = EnumSingleton.getInstance();
        ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(&quot;instance_file&quot;));
        oos.writeObject(instance);

        File file = new File(&quot;instance_file&quot;);
        ObjectInputStream ois = new ObjectInputStream(new FileInputStream(file));
        EnumSingleton readObject =(EnumSingleton) ois.readObject();

        System.out.println(instance.getData());
        System.out.println(readObject.getData());
        System.out.println(instance.getData()==readObject.getData());

    &#125;
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="https://my-xqm-srb.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2/%E7%A0%B4%E5%9D%8F%E5%8D%95%E4%BE%8B/15.png" alt="avatar"></p>
<h5 id="åå°„æ”»å‡»ï¼šæšä¸¾å•ä¾‹"><a href="#åå°„æ”»å‡»ï¼šæšä¸¾å•ä¾‹" class="headerlink" title="åå°„æ”»å‡»ï¼šæšä¸¾å•ä¾‹"></a>åå°„æ”»å‡»ï¼šæšä¸¾å•ä¾‹</h5><pre><code class="java">public static void main(String[] args) throws Exception&#123;
        //åå°„å…ˆæ‰§è¡Œ
        Class&lt;EnumSingleton&gt; aClass = EnumSingleton.class;
        Constructor&lt;EnumSingleton&gt; constructor = aClass.getDeclaredConstructor();
        constructor.setAccessible(true);
        EnumSingleton newInstance = constructor.newInstance(null);

        EnumSingleton instance = EnumSingleton.getInstance();
        System.out.println(instance);
        System.out.println(newInstance);
        System.out.println(instance==newInstance);

    &#125;
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="https://my-xqm-srb.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2/%E7%A0%B4%E5%9D%8F%E5%8D%95%E4%BE%8B/16.png" alt="avatar"></p>
<p>Javaè§„èŒƒå­—è§„å®šï¼Œæ¯ä¸ªæšä¸¾ç±»å‹åŠå…¶å®šä¹‰çš„æšä¸¾å˜é‡åœ¨JVMä¸­éƒ½æ˜¯å”¯ä¸€çš„ï¼Œå› æ­¤åœ¨æšä¸¾ç±»å‹çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ä¸Šï¼ŒJavaåšäº†ç‰¹æ®Šçš„è§„å®šã€‚åœ¨åºåˆ—åŒ–çš„æ—¶å€™Javaä»…ä»…æ˜¯å°†æšä¸¾å¯¹è±¡çš„nameå±æ€§è¾“åˆ°ç»“æœä¸­ï¼Œååºåˆ—åŒ–çš„æ—¶å€™åˆ™æ˜¯é€šè¿‡java.lang.Enumçš„valueOf()æ–¹æ³•æ¥æ ¹æ®åå­—æŸ¥æ‰¾æšä¸¾å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåºåˆ—åŒ–çš„æ—¶å€™åªå°†DATASOURCEè¿™ä¸ªåç§°è¾“å‡ºï¼Œååºåˆ—åŒ–çš„æ—¶å€™å†é€šè¿‡è¿™ä¸ªåç§°ï¼ŒæŸ¥æ‰¾å¯¹åº”çš„æšä¸¾ç±»å‹ï¼Œå› æ­¤ååºåˆ—åŒ–åçš„å®ä¾‹ä¹Ÿä¼šå’Œä¹‹å‰è¢«åºåˆ—åŒ–çš„å¯¹è±¡å®ä¾‹ç›¸åŒã€‚</p>
<h5 id="æ€»ç»“ï¼šæšä¸¾å•ä¾‹-å¤©ç„¶çš„é˜²å¾¡ååºåˆ—åŒ–å’Œåå°„æ”»å‡»ï¼Œé¥¿æ±‰å¼å’Œé™æ€å†…éƒ¨ç±»ä¹Ÿå¯ä»¥é˜²å¾¡-éœ€è¦æä¾›readResolve-æ–¹æ³•å’Œå¯¹æ„é€ å‡½æ•°åˆ¤æ–­ï¼Œæ‡’æ±‰å¼å’Œå®¹å™¨å•ä¾‹-å¯ä»¥é˜²å¾¡ååºåˆ—åŒ–æ”»å‡»ï¼Œä½†ä¸èƒ½å®Œå…¨é˜²å¾¡åå°„æ”»å‡»ã€‚"><a href="#æ€»ç»“ï¼šæšä¸¾å•ä¾‹-å¤©ç„¶çš„é˜²å¾¡ååºåˆ—åŒ–å’Œåå°„æ”»å‡»ï¼Œé¥¿æ±‰å¼å’Œé™æ€å†…éƒ¨ç±»ä¹Ÿå¯ä»¥é˜²å¾¡-éœ€è¦æä¾›readResolve-æ–¹æ³•å’Œå¯¹æ„é€ å‡½æ•°åˆ¤æ–­ï¼Œæ‡’æ±‰å¼å’Œå®¹å™¨å•ä¾‹-å¯ä»¥é˜²å¾¡ååºåˆ—åŒ–æ”»å‡»ï¼Œä½†ä¸èƒ½å®Œå…¨é˜²å¾¡åå°„æ”»å‡»ã€‚" class="headerlink" title="æ€»ç»“ï¼šæšä¸¾å•ä¾‹ å¤©ç„¶çš„é˜²å¾¡ååºåˆ—åŒ–å’Œåå°„æ”»å‡»ï¼Œé¥¿æ±‰å¼å’Œé™æ€å†…éƒ¨ç±»ä¹Ÿå¯ä»¥é˜²å¾¡ éœ€è¦æä¾›readResolve()æ–¹æ³•å’Œå¯¹æ„é€ å‡½æ•°åˆ¤æ–­ï¼Œæ‡’æ±‰å¼å’Œå®¹å™¨å•ä¾‹ å¯ä»¥é˜²å¾¡ååºåˆ—åŒ–æ”»å‡»ï¼Œä½†ä¸èƒ½å®Œå…¨é˜²å¾¡åå°„æ”»å‡»ã€‚"></a>æ€»ç»“ï¼šæšä¸¾å•ä¾‹ å¤©ç„¶çš„é˜²å¾¡ååºåˆ—åŒ–å’Œåå°„æ”»å‡»ï¼Œé¥¿æ±‰å¼å’Œé™æ€å†…éƒ¨ç±»ä¹Ÿå¯ä»¥é˜²å¾¡ éœ€è¦æä¾›readResolve()æ–¹æ³•å’Œå¯¹æ„é€ å‡½æ•°åˆ¤æ–­ï¼Œæ‡’æ±‰å¼å’Œå®¹å™¨å•ä¾‹ å¯ä»¥é˜²å¾¡ååºåˆ—åŒ–æ”»å‡»ï¼Œä½†ä¸èƒ½å®Œå…¨é˜²å¾¡åå°„æ”»å‡»ã€‚</h5><p><a class="link"   target="_blank" rel="noopener" href="https://github.com/huangjie-qq/Singleton" >ä»£ç åœ°å€<i class="fas fa-external-link-alt"></i></a></p>

        </div>

        

        
            <div class="article-nav">
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2021/11/16/%E5%8D%95%E4%BE%8B%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">å•ä¾‹çš„äº”ç§å®ç°</span>
                                <span class="post-nav-item">ä¸‹ä¸€ç¯‡</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
            <div class="comment-container">
                <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments">&nbsp;è¯„è®º</i>
    </div>
    

        
            
    <div class="valine-container">
        <script 
                src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
        <div id="vcomments"></div>
        <script >
            function loadValine() {
                new Valine({
                    el: '#vcomments',
                    appId: '7nVegzByflMPenl1NTSoUmDj-gzGzoHsz',
                    appKey: 'YxcFTbLd95Y2xVFTnL9HwcFL',
                    meta: ['nick', 'mail', 'link'],
                    avatar: 'wavatar',
                    enableQQ: true,
                    placeholder: 'ğŸ˜œ å°½æƒ…åæ§½å§~',
                    lang: 'zh-CN'.toLowerCase()
                });

                function getAuthor(language) {
                    switch (language) {
                        case 'en':
                            return 'Author';
                        case 'zh-CN':
                            return 'åšä¸»';
                        default:
                            return 'Master';
                    }
                }

                // Add "Author" identify
                const getValineDomTimer = setInterval(() => {
                    const vcards = document.querySelectorAll('#vcomments .vcards .vcard');
                    if (vcards.length > 0) {
                        let author = 'å°çƒæŸ';

                        if (author) {
                            for (let vcard of vcards) {
                                const vnick_dom = vcard.querySelector('.vhead .vnick');
                                const vnick = vnick_dom.innerHTML;
                                if (vnick === author) {
                                    vnick_dom.innerHTML = `${vnick} <span class="author">${getAuthor(KEEP.hexo_config.language)}</span>`
                                }
                            }
                        }
                        clearInterval(getValineDomTimer);
                    } else {
                        clearInterval(getValineDomTimer);
                    }
                }, 2000);
            }

            if ('false') {
                const loadValineTimeout = setTimeout(() => {
                    loadValine();
                    clearTimeout(loadValineTimeout);
                }, 1000);
            } else {
                window.addEventListener('DOMContentLoaded', loadValine);
            }
        </script>
    </div>



        
    
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>
              -
            
            2021&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">å°çƒæŸ</a>
        </div>
        
            <script async  src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        è®¿é—®äººæ•°&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        æ€»è®¿é—®é‡&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            ç”± <a target="_blank" href="https://hexo.io">Hexo</a> é©±åŠ¨&nbsp;|&nbsp;ä¸»é¢˜&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.3</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fas fa-comment"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="æœç´¢..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>



    
<script src="/js/local-search.js"></script>




    
<script src="/js/code-copy.js"></script>





<div class="post-scripts">
    
</div>



</body>
</html>
